{"ast":null,"code":"const express = require(\"express\");\n\nconst router = express.Router();\n\nconst twilio = require(\"twilio\");\n\nconst AccessToken = twilio.jwt.AccessToken;\nconst {\n  VideoGrant\n} = AccessToken;\nconst config = {\n  accountSid: process.env.TWILIO_ACCOUNT_SID,\n  apiKey: process.env.TWILIO_API_KEY,\n  apiSecret: process.env.TWILIO_API_SECRET\n};\n\nconst generateToken = config => {\n  return new AccessToken(config.accountSid, config.apiKey, config.apiSecret);\n};\n\nconst videoToken = (identity, room, config) => {\n  let videoGrant;\n\n  if (typeof room !== \"undefined\") {\n    videoGrant = new VideoGrant({\n      room\n    });\n  } else {\n    videoGrant = new VideoGrant();\n  }\n\n  const token = generateToken(config);\n  token.addGrant(videoGrant);\n  token.identity = identity;\n  return token;\n};\n\nexport default ((req, res) => {\n  const identity = req.body.identity;\n  const room = req.body.room;\n  const token = videoToken(identity, room, config);\n  res.set(\"Content-Type\", \"application/json\");\n  res.send(JSON.stringify({\n    token: token.toJwt()\n  }));\n});\nrouter.post(\"/api/video/token\", (req, res) => {});","map":null,"metadata":{},"sourceType":"module"}